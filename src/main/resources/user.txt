
IF OBJECT_ID(N'customer', N'D') IS NULL
    CREATE DATABASE customer;
    GO;

IF OBJECT_ID(N'roles', N'U') IS NULL
    CREATE TABLE roles (
        id INT PRIMARY KEY,
        role VARCHAR(20) NOT NULL
    );
    Go

CREATE TABLE Customer (
    id INT NOT NULL IDENTITY(1, 1),
    firstName VARCHAR(255) NOT NULL,
    lastName VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    password VARCHAR(255),
    role VARCHAR(255) NOT NULL,
    billing_details INT,
    CONSTRAINT CustomerPk PRIMARY KEY(id),
    CONSTRAINT CustomerAk UNIQUE(email),
    CONSTRAINT BillingDetails_Fk FOREIGN KEY (billing_details)
        REFERENCES billing_details(id)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);
GO

CREATE TABLE billing_details (
    id INT NOT NULL CONSTRAINT BillingDetails_PK PRIMARY KEY IDENTITY(100, 5),
    accountNumber VARCHAR(15),
    tariff INT NULL DEFAULT 0,
    customer_Id INT,
    CONSTRAINT Customer_FK FOREIGN KEY (customer_id)
        REFERENCES customer(id)
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
)

